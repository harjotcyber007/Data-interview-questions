SQL interview question 

1 return students names whose friends are earning more salary than them
DROP TABLE IF EXISTS students;DROP TABLE IF EXISTS friends;DROP TABLE IF EXISTS packages;CREATE TABLE students (    id INT,    name VARCHAR(10));CREATE TABLE friends (    id INT,    friend_id INT);CREATE TABLE packages (    id INT,    salary FLOAT);INSERT INTO students VALUES(1, 'Mahi'),(2, 'Mahendra'),(3, 'Paresh'),(4, 'Sam'),(5, 'Rajesh');INSERT INTO friends VALUES(1, 2),(2, 4),(3, 5),(4, 1),(5, 3);INSERT INTO packages VALUES(1, 12.5),(2, 9.6),(3, 16.2),(4, 8.4),(5, 10.8);WITH cte AS (    SELECT p.id AS student_id, f.friend_id, p.salary AS student_salary     FROM packages p     JOIN friends f ON p.id = f.id),cte2 AS (    SELECT cte.student_id, cte.friend_id, cte.student_salary, c1.salary AS friend_salary     FROM cte     JOIN packages c1 ON cte.friend_id = c1.id)SELECT s.name AS student_name, s2.name AS friend_name, c2.student_salary, c2.friend_salaryFROM cte2 c2JOIN students s ON c2.student_id = s.id JOIN students s2 ON c2.friend_id = s2.idWHERE c2.friend_salary > c2.student_salary;
